auth_enabled: false

server:
  http_listen_port: 3100

ingester:
  chunk_idle_period: 5m
  chunk_retain_period: 30s

schema_config:
  configs:
    - from: 2024-01-01
      store: tsdb
      object_store: filesystem
      schema: v13
      index:
        prefix: index_
        period: 24h

storage_config:
  filesystem:
    directory: /var/loki/chunks

# Labels structurés obligatoires pour isolation tenant
# Tous les logs DOIVENT avoir: tenant_id, cluster_id, component
pipeline_stages:
  - json:
      expressions:
        tenant_id: tenant_id
        cluster_id: cluster_id
        component: component
        level: level
  - labels:
      tenant_id:
      cluster_id:
      component:
      level:

limits_config:
  enforce_metric_name: false
  reject_old_samples: true
  reject_old_samples_max_age: 168h
  # Isolation: chaque tenant ne peut requêter que ses propres logs
  per_tenant_override_config: /etc/loki/tenant-overrides.yaml
